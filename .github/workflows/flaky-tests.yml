name: Flaky Tests
on: [push]

jobs:
  build:
    name: Running Flaky Tests
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout main branch
        uses: actions/checkout@v2
        with:
          repository: TestingResearchIllinois/idoft
          ref: b31c29526ac35b32b03d8cf9017e79a51fbe43e8      
        
      - name: Set up JDK
        uses: actions/setup-java@v1
        with:
          java-version: 1.8
          
      - name: Get 10 random tests
        run: grep ,ID,, pr-data.csv | grep -v \\[ | shuf --random-source=<(while :; do echo kgomez22@gmu.edu; done) | head
      
      - name: Clone test's repo
        run: | 
             git clone https://github.com/vojtechhabarta/typescript-generator
             cd typescript-generator
     
      - name: Checkout the latest commit
        uses: actions/checkout@v2
        with:
          repository: vojtechhabarta/typescript-generator
          ref: c19d407fea52612e7b7cd20620059736aec9a6a9
          
      - name: Compile the module
        run: mvn test-compile -pl typescript-generator-core -am
        
      - run: ls
